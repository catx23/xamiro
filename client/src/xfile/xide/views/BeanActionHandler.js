//>>built
define("xide/views/BeanActionHandler",["dojo/_base/declare","xide/types"],function(d,c){return d("xide.views.BeanActionHandler",null,{_activeBeanView:null,_activeItem:null,_activeBeanType:null,_logging:!0,_getBeanType:function(a){if(a&&a.beanType)return a.beanType;var b=a.view||a.owner;return b&&b.beanType?b.beanType:(a=a.item)&&a.beanType?a.beanType:null},_getBeanView:function(a){return(a=a.view||a.owner)&&null!=a.hasItemActions?a:null},_setCurrentBeanType:function(a){return this._activeBeanType!==
a?(this._activeBeanType=a,!0):!1},_changeBeanContext:function(a,b,e){if(null==b||null==a)console.error("_changeBeanContext : invalid params",arguments);else if(!a.beanContextName||!this.beanContextName||a.beanContextName==this.beanContextName){this.publish(c.EVENTS.ON_ACTION_CHANGE_CONTEXT,{item:e,beanType:b,view:a,settings:{shouldChange:!0}});var d=this;setTimeout(function(){d.publish(c.EVENTS.ON_ACTION_CONTEXT_CHANGED,{item:e,beanType:b,view:a})},10)}},_setCurrentBeanView:function(a){if(this._activeBeanView!=
a&&null!=a){this._activeBeanView=a;var b=this._getBeanType(a);b&&this._setCurrentBeanType(b);a&&this._changeBeanContext(this._activeBeanView,this._activeBeanType,this._activeItem)}},_isBeanView:function(a){return a&&a.hasItemActions&&a.hasItemActions()},_onItemSelected:function(a){if(!a._didBM&&(a._didBM=!0,a.item)){var b=this._getBeanType(a);b&&(b=this._setCurrentBeanType(b),this._activeItem=a.item,a=this._getBeanView(a),b&&a&&this._isBeanView(a)&&(this._activeBeanView=a,this._changeBeanContext(this._activeBeanView,
this._activeBeanType,this._activeItem)))}},_onViewRemoved:function(a){a.view&&a.view==this._activeBeanView&&this._setCurrentBeanView(null)},_onShowView:function(a){if(!a._didBM){a._didBM=!0;var b=a?a.view?a.view:null:null;b&&this._isBeanView(b)&&((a=this._getBeanType(a))&&this._setCurrentBeanType(a),this._setCurrentBeanView(b))}},initBeanActionHandler:function(){this.subscribe(c.EVENTS.ON_ITEM_SELECTED,this._onItemSelected);this.subscribe(c.EVENTS.ON_VIEW_SHOW,this._onShowView);this.subscribe(c.EVENTS.ON_VIEW_REMOVED,
this._onViewRemoved)}})});
//# sourceMappingURL=BeanActionHandler.js.map