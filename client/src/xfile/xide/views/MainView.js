//>>built
define("xide/views/MainView","dojo/_base/array dojo/_base/declare xide/widgets/TemplatedWidgetBase xide/widgets/_CSSMixin xide/widgets/_StyleMixin xide/widgets/_InsertionMixin dojo/dom-class xide/types xide/widgets/_PermaMixin dijit/registry xide/utils xide/factory xide/layout/BorderContainer xide/layout/ContentPane xide/layout/TabContainer xide/mixins/EventedMixin".split(" "),function(l,m,n,p,q,r,h,e,t,u,d,g,v,k,w,x){return m("xide.views.MainView",[n,p,q,r,t,x],{config:null,ctx:null,cssClass:"mainView xasMain dTuned",
layoutMain:null,layoutTop:null,layoutLeft:null,layoutCenter:null,layoutRight:null,layoutBottom:null,toolbar:null,preventCaching:!0,panelManager:null,leftPanel:null,centerPanel:null,centerTabContainer:null,breadCrumb:null,bottomTabContainer:null,logPanel:null,layoutBottomPlaceHolder:null,initialReload:!1,persistent:!1,_restoredPermaItems:0,rightBorderContainer:null,rightTopTabParent:null,rightTopTabContainer:null,rightBottomContainer:null,rightBottomTabContainer:null,layoutRightPlaceHolder:null,leftTabContainer:null,
mainMenu:null,templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'layoutMain' data-dojo-type\x3d'xide.layout.BorderContainer' data-dojo-props\x3d\"design:'headline'\" class\x3d'layoutMain '\x3e\x3cdiv data-dojo-attach-point\x3d'layoutTop' data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-props\x3d\"region:'top',splitter:'true'\" class\x3d'layoutTop ui-state-default'\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d'layoutLeft' data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-props\x3d\"region:'leading',splitter:'true'\" class\x3d'layoutLeft'\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d'layoutCenter' data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-props\x3d\"region:'center',splitter:'true'\" class\x3d'layoutCenter'\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d'layoutRight' data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-props\x3d\"region:'right',splitter:'true',minSize:'200',toggleSplitterState:'closed',toggleSplitterClosedSize:'0px',toggleSplitterFullSize:'200px' \" class\x3d'layoutRight' style\x3d'min-width: 200px;'\x3e\x3cdiv data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-attach-point\x3d'layoutRightPlaceHolder' style\x3d'min-width:200px;width: 200px;'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d'layoutBottom' data-dojo-type\x3d'xide.layout.ContentPane' data-dojo-props\x3d\"region:'bottom',splitter:'true',toggleSplitterState:'closed',toggleSplitterClosedSize:'0px',toggleSplitterFullSize:'150px'\" class\x3d'layoutBottom ui-state-default'\x3e\x3cdiv data-dojo-attach-point\x3d'layoutBottomPlaceHolder' style\x3d'height: 80px;'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
_openRight:function(){if(this.layoutRight){var a=this.layoutRight._splitterWidget;if(a)switch(a.state){case "collapsed":case "closed":a.set("state","full"),this.publish(e.EVENTS.RESIZE,{},this)}}return!0},getLeftTabContainer:function(){return this.leftTabContainer},getRightBottomTarget:function(a,b,c){return this.layoutRight?(c=this.getLayoutRightMain(),a&&d.destroyWidget([this.rightBottomTabContainer,this.rightBottomContainer],!1,this),this.rightBottomContainer||(this.rightBottomContainer=d.addWidget(k,
{style:"width:100%;height:30%;padding:0px",region:"center",parentContainer:this.rightBorderContainer},this,c)),this.rightBottomTabContainer||(a=new dijit.layout.TabContainer({tabStrip:!0,tabPosition:"top",splitter:!0,region:"center",attachParent:!0,style:"width:100%;height:100%",allowSplit:!1},dojo.doc.createElement("div")),this.rightBottomContainer.containerNode.appendChild(a.domNode),this.rightBottomTabContainer=a,a.startup()),!0===b&&this._openRight(),this.rightBottomTabContainer):null},getRightTopTarget:function(a,
b,c,e){try{if(this.layoutRight){var f=this.getLayoutRightMain(c,e);a&&d.destroyWidget([this.rightTopTabContainer,this.rightTopTabParent],!1,this);this.rightTopTabParent||(this.rightTopTabParent=d.addWidget(k,{delegate:this,style:"width:100%;height:70%;padding:0px;overflow:hidden;",region:"top",splitter:!0,parentContainer:f},this,f));this.rightTopTabContainer||(this.rightTopTabContainer=d.addWidget(dijit.layout.TabContainer,{delegate:this,tabStrip:!0,tabPosition:"top",attachParent:!0,style:"width:100%;height:100%;overflow-x:hidden;",
allowSplit:!1},null,this.rightTopTabParent.containerNode,!0));a&&this.resize();!0===b&&this._openRight();return this.rightTopTabContainer}}catch(g){debugger}return null},getLayoutRightMain:function(a,b){return this.layoutRight?(this.rightBorderContainer||(this.rightBorderContainer=d.addWidget(v,{splitter:!0,design:"headline",style:a||"width:200px;height:inherit;",liveSplitters:!0,gutters:!0},this,this.layoutRight.containerNode,b,!0)),this.rightBorderContainer):null},getNewAlternateTarget:function(a,
b){if(!this.centerTabContainer){if(this.centerPanel){var c=dojo.doc.createElement("div");dojo.place(this.centerPanel.domNode,c)}c=new w({delegate:this,tabStrip:!0,tabPosition:"top",splitter:!0,region:"center",attachParent:!0,style:"width:100%;height:100%",parentContainer:this.layoutCenter,sizeTarget:this.layoutCenter.containerNode,allowSplit:!0},dojo.doc.createElement("div"));this.layoutCenter.containerNode.appendChild(c.domNode);c.startup();this.centerPanel&&c.addChild(this.centerPanel);this.centerTabContainer=
c}return this.centerTabContainer},_permaItemReady:function(a){a&&(null!=a.directory&&!0===a.directory?(this.centerPanel&&(0==this._restoredPermaItems?this.centerPanel.openItem(a):this.centerPanel.openItemAlternate(a)),this._restoredPermaItems+=1):this.panelManager.openFile(a))},getPermaLink:function(){var a=[];if(this.centerTabContainer)l.forEach(u.findWidgets(this.centerTabContainer.containerNode),function(b){b.getPermaLink&&(b=b.getPermaLink())&&"."!=b&&a.push(encodeURIComponent(b))});else if(this.centerPanel&&
this.centerPanel.getPermaLink){var b=this.centerPanel.getPermaLink();b&&"."!=b&&a.push(encodeURIComponent(b))}return a&&0<a.length?"mainView\x3d"+encodeURIComponent(a.join("|")):""},_getItem:function(a){var b=this,c=this.panelManager.store,d=function(a){b._permaItemReady(a)};setTimeout(function(){c.getItem(a,!0,d)},10)},restorePermaLink:function(a){try{var b=[];if(a=a||window.location.href){var c=d.urlDecode(a);if(c&&c.mainView){c.mainView=decodeURIComponent(c.mainView);var e=-1!=c.mainView.indexOf("|")?
c.mainView.split("|"):[c.mainView];if(e&&0<e.length)for(var f=0;f<e.length;f++)b.push(decodeURIComponent(e[f]))}}if(0<b.length)for(f=0;f<b.length;f++)this._getItem(b[f])}catch(g){debugger}},onLastPanelRemoved:function(){if(this.centerPanel&&this.centerTabContainer){var a=dojo.doc.createElement("div");dojo.place(this.centerPanel.domNode,a);d.destroyWidget(this.centerTabContainer);this.centerTabContainer=null;this.layoutCenter.containerNode.appendChild(this.centerPanel.domNode);this.resize()}},onPanelClosed:function(){if(this.centerTabContainer){var a=
!1;1==this.centerTabContainer.getChildren().length&&(a=!0);if(a)this.onLastPanelRemoved()}},prepareLayout:function(a){a.LAYOUT_PRESET==e.LAYOUT_PRESET.SINGLE&&this.layoutMain.removeChild(this.layoutLeft);null!=a.PANEL_OPTIONS&&!1===a.PANEL_OPTIONS.ALLOW_INFO_VIEW&&this.layoutMain.removeChild(this.layoutRight);null==a.PANEL_OPTIONS||!1!==a.PANEL_OPTIONS.ALLOW_BREADCRUMBS&&0!==a.PANEL_OPTIONS.ALLOW_BREADCRUMBS||null!=a.ACTION_TOOLBAR_MODE&&"self"==a.ACTION_TOOLBAR_MODE?this.layoutTop._splitterWidget&&
(d.destroyWidget(this.layoutTop._splitterWidget),this.layoutTop._splitterWidget=null):this.layoutMain.removeChild(this.layoutTop);null!=a.PANEL_OPTIONS&&!1===a.PANEL_OPTIONS.ALLOW_LOG_VIEW?this.layoutMain.removeChild(this.layoutBottom):this.layoutBottom._splitterWidget&&(this.layoutBottom._splitterWidget.fullSize="150px",this.layoutBottom._splitterWidget.collapsedSize=null,this.bottomTabContainer||(this.bottomTabContainer=this._createBottomTabContainer()))},createPanel:function(a,b,c,e){if(a.AUTO_OPEN||
null==a.AUTO_OPEN){var d=this.getPanelManager().openUrl(this.config.START_PATH,b,this.config,c,e);this.initialReload&&setTimeout(function(){d.onReload(d)},800);return d}},onChangeToggleSplitterState:function(a,b){if(this.persistent){var c=[];this.layoutLeft&&this.layoutLeft._splitterWidget&&c.push({region:"left",state:this.layoutLeft._splitterWidget.state});this.layoutRight&&this.layoutRight._splitterWidget&&c.push({region:"right",state:this.layoutRight._splitterWidget.state});this.layoutBottom&&
this.layoutBottom._splitterWidget&&c.push({region:"bottom",state:this.layoutBottom._splitterWidget.state});this.ctx.getSettingsManager().write(null,".",null,{id:"splitter",data:JSON.stringify(c),name:"Splitter States"},!0,null)}},setupToggleSplitterListeners:function(){this.layoutLeft&&this.layoutLeft._splitterWidget&&(this.layoutLeft._splitterWidget.delegate=this);this.layoutRight&&this.layoutRight._splitterWidget&&(this.layoutRight._splitterWidget.delegate=this);this.layoutBottom&&this.layoutBottom._splitterWidget&&
(this.layoutBottom._splitterWidget.delegate=this)},_getState:function(a,b){for(var c=0;c<b.length;c++)if(b[c].region==a)return b[c].state;return null},_restoreSplitter:function(){},_restoreToggleSplitters:function(){var a=this.ctx.getSettingsManager().getStore();if(a&&(a=d.queryStoreEx(a,{id:"splitter"},!0,!0))&&(a=a.data)){if(this.layoutLeft&&this.layoutLeft._splitterWidget){var b=this._getState("left",a);b&&this.layoutLeft._splitterWidget.set("state",b)}this.layoutRight&&this.layoutRight._splitterWidget&&
(b=this._getState("right",a))&&this.layoutRight._splitterWidget.set("state",b);this.layoutBottom&&this.layoutBottom._splitterWidget&&(b=this._getState("bottom",a))&&this.layoutBottom._splitterWidget.set("state",b)}},createPanels:function(a){a.LAYOUT_PRESET==e.LAYOUT_PRESET.DUAL?(this.leftPanel=this.createPanel(a.FILE_PANEL_OPTIONS_LEFT,this.layoutLeft,e.LAYOUT_REGION.LEFT,e.LAYOUT_REGION.LEFT),this.centerPanel=this.createPanel(a.FILE_PANEL_OPTIONS_MAIN,this.layoutCenter,e.LAYOUT_REGION.CENTER,e.LAYOUT_REGION.CENTER),
this.leftPanel.currentPanels.push(this.centerPanel),this.leftPanel.activePanel=this.centerPanel,this.centerPanel.currentPanels.push(this.leftPanel),this.centerPanel.owner=this.leftPanel,this.centerPanel.closeable=!1):a.LAYOUT_PRESET==e.LAYOUT_PRESET.SINGLE&&null!=a.FILE_PANEL_OPTIONS_MAIN&&this.createPanel(a.FILE_PANEL_OPTIONS_MAIN,this.layoutCenter,e.LAYOUT_REGION.CENTER)},getPanelManager:function(){return this.panelManager},onShowPanel:function(a){if((a=a?a?a.panel?a.panel:null:null:null)&&a.getCurrentPathItem){var b=
a.getCurrentPathItem();b&&this.breadCrumb&&(this.breadCrumb.setTrail(b.path),this.breadCrumb.owner=a)}},onDidOpenItem:function(a){(a=a?a?a.item?a.item:null:null:null)&&a.path&&!0===a.directory&&this.breadCrumb&&this.breadCrumb.setTrail(a.path)},createBreadCrumb:function(a){if(!this.breadCrumb){this.breadCrumb=window.xappFileTrail;this.layoutTop.containerNode.appendChild(this.breadCrumb.domNode);dojo.place(this.breadCrumb.domNode,this.layoutTop.containerNode,"last");this.breadCrumb.startup();this.layoutTop.resize();
this.layoutMain.resize();var b=this;this.breadCrumb.onClick=function(a,d){a&&b.breadCrumb.owner&&b.breadCrumb.owner.openItem&&b.breadCrumb.owner.openItem(a)}}},_createToolbarEx:function(a,b,c){"self"==a&&(this.actionToolbar=new ActionToolbarEmbedded({delegate:this.ctx.getPanelManager(),ctx:this.ctx,config:b},dojo.doc.createElement("div")),h.add(this.actionToolbar.domNode,"actionToolbarEmbedded"),c.containerNode.appendChild(this.actionToolbar.domNode),this.actionToolbar.startup())},initWithConfig:function(a){var b=
this;try{h.add(this.layoutRight.domNode,"ui-state-default"),setTimeout(function(){b.prepareLayout(a)},100),setTimeout(function(){b.createPanels(a);b.restorePermaLink(null)},200),setTimeout(function(){if(a&&null!=a.ACTION_TOOLBAR_MODE)try{b._createToolbarEx(a.ACTION_TOOLBAR_MODE,a,b.layoutTop)}catch(c){}if(null!=a.PANEL_OPTIONS&&(!0===a.PANEL_OPTIONS.ALLOW_BREADCRUMBS||1===a.PANEL_OPTIONS.ALLOW_BREADCRUMBS))try{b.createBreadCrumb(a)}catch(d){debugger}b.repaint()},500)}catch(c){debugger}},removeEmptyContainers:function(){d.destroyIfEmpty(this.layoutRight);
d.destroyIfEmpty(this.layoutCenter);d.destroyIfEmpty(this.layoutLeft);d.destroyIfEmpty(this.layoutTop);d.destroyIfEmpty(this.layoutBottom)},postMixInProperties:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.buttons=[];this.toolbar&&(this.toolbar.delegate=this);this._setupTranslations()},_resizeContainer:function(a,b){try{a&&a.domNode&&a.resize()}catch(c){console.error("_resizeContainer : failed for "+b)}},_fixToolbar:function(){this.toolbar&&this.layoutBottom&&
this.layoutMain&&this.layoutBottom.domNode&&dojo.place(this.toolbar.domNode,this.layoutBottom.domNode,"before")},resize:function(){this.inherited(arguments);this.layoutMain&&this._resizeContainer(this.layoutMain,"main");this.layoutLeft&&this._resizeContainer(this.layoutLeft,"left");this.layoutTop&&this._resizeContainer(this.layoutTop,"top");this.layoutCenter&&this._resizeContainer(this.layoutCenter,"center");this.layoutRight&&this._resizeContainer(this.layoutRight,"right");this.layoutLeft&&this._resizeContainer(this.layoutLeft,
"left");this.layoutBottom&&this._resizeContainer(this.layoutBottom,"bottom")},onStartupPost:function(){var a=this;dojo.connect(null,void 0!==dojo.global.onorientationchange?"onorientationchange":"onresize",this,function(){a.resize()});g.subscribe(e.EVENTS.RESIZE,a.resize,this);g.subscribe(e.EVENTS.ON_DID_OPEN_ITEM,a.onDidOpenItem,this);g.subscribe(e.EVENTS.UPLOAD_BEGIN,a.onUploadBegin,this);this.removeEmptyContainers();this.resize()},postCreate:function(){this.inherited(arguments)},buildRendering:function(){this.inherited(arguments)},
_createBottomTabContainer:function(){this.layoutBottomPlaceHolder&&(d.destroyWidget(this.layoutBottomPlaceHolder),this.layoutBottomPlaceHolder=null);var a=new dijit.layout.TabContainer({tabStrip:!0,tabPosition:"bottom",region:"bottom",attachParent:!0,style:"width:100%"},dojo.doc.createElement("div"));this.layoutBottom.containerNode.appendChild(a.domNode);a.startup();return a},showLogPanel:function(){if(null!=this.config.PANEL_OPTIONS&&!1===this.config.PANEL_OPTIONS.ALLOW_LOG_VIEW)return!1;this.bottomTabContainer||
(this.bottomTabContainer=this._createBottomTabContainer());this.bottomTabContainer&&this.logPanel&&this.bottomTabContainer.selectChild(this.logPanel);var a=this.layoutBottom._splitterWidget;if(a)switch(a.state){case "collapsed":case "closed":a.set("state","full")}return!0},repaint:function(a,b){var c=dojo.window.getBox();null!=b&&dojo.byId(b)?this.resizeToNode(b):(c=c.h,this.layoutMain.containerNode.style.height=c-10+"px",this.layoutMain.resize())},onChildAdded:function(a,b){this.resize()}})});
//# sourceMappingURL=MainView.js.map